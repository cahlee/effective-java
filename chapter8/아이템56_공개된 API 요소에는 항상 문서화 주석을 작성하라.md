아이템 56_공개된 API 요소에는 항상 문서화 주석을 작성하라
---

쓸모 있는 API에는 잘 작성된 문서도 필요하다.  
자바에서는 자바독(Javadoc)이라는 유틸리티를 지원하고 있는데, 소스코드 파일에서 문서화 주석이라는 특수한 형태로 기술된 설명을 추려 API 문서로 변환해준다.

### 문서화 주석을 다는 방법
1) 공개된 모든 클래스, 인터페이스, 메서드, 필드 선언에 문서화 주석을 달아야 한다. 단, 기본 생성자에는 주석을 달 방법이 없으니 공개 클래스는 절대 기본 생성자를 사용하면 안된다.

2) 메소드용 문서화 주석에서는 해당 메서드와 클라이언트 사이의 규약을 명료하게 기술해야 한다.

- 메서드의 동작 과정(how)이 아닌 아닌 무엇을 하는지(what) 기술
- 클라이언트가 해당 메서드를 호출하기 위한 전제조건 나열
- 메서드가 수행된 후에 만족해야 하는 사후조건 나열
- 사후조건으로 명확하게 나타나지 않지만 시스템 상태에 어떠한 변화를 가져오는 부작용 기술(ex) 백그라운드 슬드)

### 메서드 주석
- 메서드의 계약을 완벽히 기술하려면, 다음의 규칙을 따라 작성하면 된다.

1.모든 매개변수에 @param 태그   
2.반환 타입이 void가 아니라면 @return 태그   
3.발생할 가능성이 있는 모든 예외(검사/비검사)에 @throws 태그   

```java
   /**
     * 이 리스트에서 지정한 위치의 원소를 반환한다.
     *
     * <p>이 메서드는 상수 시간에 수행됨을 보장하지 <i>않는다</i>. 구현에 따라 
     * 원소의 위치에 비례해 시간이 걸릴수 있다.
     *
     * @param  index 반환할 원소의 인덱스; 0 이상이고 리스트 크기보다 작아야 한다.
     * @return 이 리스트에서 지정한 위치의 원소
     * @throws IndexOutOfBoundsException index가 이 범위를 벗어나면,
     *         ({@code index < 0 || index >= this.size()})이면 발생한다.
     */
    E get(int index) {
        return null;
    }
```
자바독 유틸리티는 문서화 주석을 HTML로 변환하므로 문서화 주석 안의 HTML 요소들이 최종 HTML문서에 반영된다.  

   
@code 는 태그로 감싼 내용을 코드용 폰트로 렌더링하며, 감싼 내용에 포함된 HTML 요소나 다른 자바독 태그를 무시하는 역할을 한다. 여러줄로 된 코드 예시를 넣으려면 <pre>{@code ...}</pre> 형태로 쓰면 된다.

### 상속용 클래스 문서화 주석
클래스를 상속용으로 설계할 때는, @implSpec 을 사용해 자기사용 패턴을 문서로 남겨 메서드를 올바르게 재정의하는 방법을 알려줘야 한다.
(아이템 15 : 클래스와 맴버의 접근 권한을 최소화하라에서 얘기했듯 클래스를 상속용으로 설계할 때는 자기사용 패턴에 대해서도 문서를 남겨 다른프로그래머에게 메소드를 올바르게 재정의 하는 방법을 남겨야함.)

@impleSpec   
해당 메서드와 하위 클래스 사이의 계약을 설명   
하위 클래스들이 그 메서드를 상속하거나 super 키워드를 이용해 호출할 때 그 메서드가 어떻게 동작하는지 명확히 인지하고 사용할 수 있도록 도와주는 역할   

```java
  /**
     * 이 컬렉션이 비었다면 TRUE를 반환한다.// 요약 설명
     *
     * @implSpec 이 구현은 {@code this.size() == 0}의 결과를 반환한다.
     *
     * @return 이 컬렉션이 비었다면 TRUE 아니라면 FALSE
     */
    public boolean isEmpty() {
        list.size() = 0 ? return true : return false;
    }
```
참고로, 자바 11 이전까지는 자바독 명령줄에서 다음의 스위치를 켜주지 않으면 해당 태그를 무시해버린다.  

``` java
-tag "implSpec:a:Implementation Requirements:"`
```

api 설명에서 <,>,& 등의 html 메타문자를 포함시키려면 @literal을 사용한다.  
ex) * {@literal |r| < 1}이면 기하 수열이 수렴한다. -> |r| < 1이면 기하 수열이 수렴한다. 로 변환됌.


### 요약 설명
요약 설명(summary description)이란, 각 문서화 주석의 첫 번째 문장을 말한다.  
2인칭 문장이 아닌 3인칭 문장으로 기술하는게 좋다.

```java
//아래 메소드의 예시들

Collection.size() : 이 컬렉션 안의 원소 개수를 반환한다. // 동사

ArrayList(int initialCapacity) : 지정한 초기 용량을 갖는 빈 리스트를 생성한다.

Instant : 타임라인상의 특정 순간(지점)   // 명사절
```

중요한 점은 반드시 대상의 기능을 고유하게 기술해야 한다는 것이다.   
즉, 한 클래스 안에서 요약 설명이 똑같은 멤버 혹은 생성자가 둘 이상이면 안되므로 특히 다중정의된 메서드에서 조심하자.  
또한 요약 설명은 마침표를 기준으로 구분되기 때문에, {@literal} 로 감싸주어 의도치 않은 마침표로 인한 혼동을 해결할 수 있다.


##### 문서화 주석 첫 '문장'에 마침표가 있을 때 요약 설명 처리
```java
// 예시 : 머스타드 대령이나 Mrs.피콕 같은 용의자.
// Mrs. 의 마침표로 @literal 처리 해주지 않으면 Mrs.까지만 요약이 되버린다.
 /**
 * 머스타드 대령이나 {@literal Mrs. Peacock} 같은 용의자
 */
  public enum Suspect {...}
```
##### @Summary 이용: 자바 10 이후
```java
  /**
  *{@summary A suspect, such as Colonel Mustard or Mrs. Peacock.}
  */
  public enum Suspect {...}
```

### 문서화 주석의 검색 기능
자바 9 이후부터는, 자바독이 생성한 HTML 문서에 검색(색인) 기능이 추가되었다.   
클래스, 메서드, 필드 같은 API 요소의 색인은 자동으로 만들어지며 원한다면 {@Index} 태그를 사용해 API에서 중요한 용어를 추가로 색인화할 수 있다.
```java
/**
*이 메서드는 {@index IEEE 754} 표준을 준수한다.
**/
public void fragment2() {...}
```

### 제네릭 타입과 문서화 주석
제네릭 타입이나 제네릭 메서드를 문서화 할때는, 모든 타입 매개변수에 주석을 달아야 한다.
```java
/**
* 키와 값을 매핑하는 객체. 맵은 킬르 중복해서 가질 수 없다.
* 즉, 키와 하나가 가리킬 수 있는 값은 최대 1개이다.
* (나머진 생략)
*
* @param <K> the type of keys maintained by this map
* @param <V> the type of mapped values
*/
public interface Map<K, V> {...}
```
### 열거 타입과 문서화 주석
열거 타입을 문서화할 때는 상수들에도 주석을 달아야 한다.
```java
/**
* 심포니 오케스트라의 악기 세션
*/
public enum OrchestraSection {
    /** 플루투, 클라리엣, 오보에 같은 목관 악기 */
    WOODWIND,

    /** 프렌치 호른, 트렘펫 같은 금관악기 */
    BRASS,

    /** 팀파니, 심벌즈 같은 타악기 */
    PERCUSSION,

  /** 바이올린, 첼로 같은 현악기. */ 
    STRING;
}
```
### 애너테이션과 문서화 주석
애너테이션 타입을 문서화할 때는 멤버들에도 모두 주석을 달아야 한다.
애너테이션 타입의 요약 설명에서는, 이 애너테이션을 단다는 것이 어떤 의미인지를 설명하면 된다.
```java
/**
* 이 에너테이션이 달린 메서드는 명시한 예외를 던져야만 성공하는
* 테스트 메서드임을 나타낸다.
*/
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface ExceptionTest {
    /**
    * 이 에너테이션을 단 테스트 메서드가 성공하려면 던져야 하는 예외 .
    * ( 이 클래스의 하위 타입 예외는 모두 허용된다).
    */
    Class<? extends Throwable> value();
}
```

### 스레드 안정성과 직렬화 가능성
- 클래스 혹은 정적 메서드가 스레드 안전하든 그렇지 않든, 스레드 안전수준을 반드시 API 설명에 포함해야한다.
- 직렬화 할수 있는 클래스라면 직렬화 형태도 API 설명에 기술해야한다.

### 추가 기능
- 자바독은 메서드 주석을 '상속' 시킬수 있다.
  (문서화 주석이 없는 API 요소를 발견하면 자바독이 가장 가까운 문서화 주석을 찾아준다.   
  (상세한 검색 알고리즘은 내용은 자바독 참조지침 참고))
- {@inhertiDoc} 태그를 사용해 상위 타입의 문서화 주석 일부를 상속할 수 있다.
- 모든 주석을 달아도 충분치 않을때는 문서 링크를 제공하면 좋다.
- 자바독은 프로그래머가 자바독 문서를 올바르게 작성했는지 확인하는 기능을 제공한다.  
    자바 7에서는 명령줄에서 -Xdoclint 스위치를 켜주면 이 기능이 활성화되고, 자바 8부터 기본작동.
    checkstyle 같은 IDE 플러그인을 사용하면 더 완벽하게 검사됌.   
    자바독이 생성한 HTML 파일을 HTML 유효성 검사기로 돌리면 문서화 주석 오류를 줄일수 있다.  
    자바 9와 10의 자바독은 기본적으로 HTML.4.01 문서를 생성하지만, 명령줄에서 -html5 스위치를 켜면 HTML 5버전으로 만들어준다.

##### 어쨌든, 정말 잘 쓰인 문서인지를 확인하는 유일한 방법은 자바독 유틸리티가 생성한 웹 페이지를 읽어보는 길 뿐이다.

📚 핵심 정리
문서화 주석은 API를 문서화하는 가장 훌륭하고 효과적인 방법이다.    
공개 API라면 모두 설명을 달아야 하며, 표준 규약을 일관되게 지키자.    
문서화 주석에 임의의 HTML 태그를 사용할 수 있음을 기억하라.   
단, HTML 메타문자는 특별하게 취급해야 한다.
